

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Chaincode namespace &mdash; hyperledger-fabricdocs master documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Transaction context" href="transactioncontext.html" />
    <link rel="prev" title="Contract namespaces" href="namespace.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          


          
            <a href="../index.html" class="icon icon-home"> hyperledger-fabricdocs
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          

<br><img style="background-color: #fff; height: unset; width: unset;" alt="Hyperledger Fabric" src=../_images/hyperledger_fabric_logo_color.png />
<br>
<a href="https://github.com/hyperledger/fabric"><img style="padding: 0px; margin: auto auto auto auto;" alt="GitHub" src="../_static/images/github_button.png"/></a>
&nbsp;<a href="https://stackoverflow.com/questions/tagged/hyperledger-fabric"><img style="padding: 0px; margin: auto auto auto auto;" alt="StackOverflow" src="../_static/images/stackoverflow_button.png"/></a>
&nbsp;<a href="https://chat.hyperledger.org"><img style="padding: 0px; margin: auto auto auto auto;" alt="Rocket Chat" src="../_static/images/rocketchat_button.png"/></a>
&nbsp;<a href="https://www.youtube.com/playlist?list=PL0MZ85B_96CH7wvtrRzV7SvtRY0sI0DEg"><img style="padding: 0px; margin: auto auto auto auto;" alt="Youtube Channel" src="../_static/images/youtube_button.png"/></a>

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../whatis.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew.html">What’s new in v1.4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew.html#release-notes">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../key_concepts.html">Key Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="developing_applications.html">Developing Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="scenario.html">The scenario</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis.html">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">Process and Data Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="smartcontract.html">Smart Contract Processing</a></li>
<li class="toctree-l2"><a class="reference internal" href="application.html">Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="apis.html">APIs</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="designelements.html">Application design elements</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="namespace.html">Contract namespaces</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Chaincode namespace</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#motivation">Motivation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scenario">Scenario</a></li>
<li class="toctree-l4"><a class="reference internal" href="#channels">Channels</a></li>
<li class="toctree-l4"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cross-chaincode-access">Cross chaincode access</a></li>
<li class="toctree-l4"><a class="reference internal" href="#considerations">Considerations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="transactioncontext.html">Transaction context</a></li>
<li class="toctree-l3"><a class="reference internal" href="transactionhandler.html">Transaction handlers</a></li>
<li class="toctree-l3"><a class="reference internal" href="endorsementpolicies.html">Endorsement policies</a></li>
<li class="toctree-l3"><a class="reference internal" href="connectionprofile.html">Connection Profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="connectionoptions.html">Connection Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="wallet.html">Wallet</a></li>
<li class="toctree-l3"><a class="reference internal" href="gateway.html">Gateway</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ops_guide.html">Operations Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../command_ref.html">Commands Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Architecture Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Fabric-FAQ.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributions Welcome!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../questions.html">Still Have Questions?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../status.html">Status</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hyperledger-fabricdocs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="developing_applications.html">Developing Applications</a> &raquo;</li>
        
          <li><a href="designelements.html">Application design elements</a> &raquo;</li>
        
      <li>Chaincode namespace</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/developapps/chaincodenamespace.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="chaincode-namespace">
<h1>Chaincode namespace<a class="headerlink" href="#chaincode-namespace" title="Permalink to this headline">¶</a></h1>
<p><strong>Audience</strong>: Architects, application and smart contract developers,
administrators</p>
<p>A chaincode namespace allows it to keep its world state separate from other
chaincodes. Specifically, smart contracts in the same chaincode share direct
access to the same world state, whereas smart contracts in different chaincodes
cannot directly access each other’s world state. If a smart contract needs to
access another chaincode world state, it can do this by performing a
chaincode-to-chaincode invocation. Finally, a blockchain can contain
transactions which relate to different world states.</p>
<p>In this topic, we’re going to cover:</p>
<ul class="simple">
<li><a class="reference external" href="#motivation">The importance of namespaces</a></li>
<li><a class="reference external" href="#scenario">What is a chaincode namespace</a></li>
<li><a class="reference external" href="#channels">Channels and namespaces</a></li>
<li><a class="reference external" href="#usage">How to use chaincode namespaces</a></li>
<li><a class="reference external" href="#cross-chaincode-access">How to access world states across smart contracts</a></li>
<li><a class="reference external" href="#considerations">Design considerations for chaincode namespaces</a></li>
</ul>
<div class="section" id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<p>A namespace is a common concept. We understand that <em>Park Street, New York</em> and
<em>Park Street, Seattle</em> are different streets even though they have the same
name. The city forms a <strong>namespace</strong> for Park Street, simultaneously providing
freedom and clarity.</p>
<p>It’s the same in a computer system. Namespaces allow different users to program
and operate different parts of a shared system, without getting in each other’s
way. Many programming languages have namespaces so that programs can freely
assign unique identifiers, such as variable names, without worrying about other
programs doing the same. We’ll see that Hyperledger Fabric uses namespaces to
help smart contracts keep their ledger world state separate from other smart
contracts.</p>
</div>
<div class="section" id="scenario">
<h2>Scenario<a class="headerlink" href="#scenario" title="Permalink to this headline">¶</a></h2>
<p>Let’s examine how the ledger world state organizes facts about business objects
that are important to the organizations in a channel using the diagram below.
Whether these objects are commercial papers, bonds, or vehicle registrations,
and wherever they are in their lifecycle, they are maintained as states within
the ledger world state database. A smart contract manages these business objects
by interacting with the ledger (world state and blockchain), and in most cases
this will involve it querying or updating the ledger world state.</p>
<p>It’s vitally important to understand that the ledger world state is partitioned
according to the chaincode of the smart contract that accesses it, and this
partitioning, or <em>namespacing</em> is an important design consideration for
architects, administrators and programmers.</p>
<p><img alt="../_images/develop.diagram.50.png" src="../_images/develop.diagram.50.png" />chaincodens.scenario <em>The ledger world state is
separated into different namespaces according to the chaincode that accesses it.
Within a given channel, smart contracts in the same chaincode share the same
world state, and smart contracts in different chaincodes cannot directly access
each other’s world state. Likewise, a blockchain can contain transactions that
relate to different chaincode world states.</em></p>
<p>In our example, we can see four smart contracts defined in two different
chaincodes, each of which is in their own chaincode container. The <code class="docutils literal notranslate"><span class="pre">euroPaper</span></code>
and <code class="docutils literal notranslate"><span class="pre">yenPaper</span></code> smart contracts are defined in the <code class="docutils literal notranslate"><span class="pre">papers</span></code> chaincode. The
situation is similar for the <code class="docutils literal notranslate"><span class="pre">euroBond</span></code> and <code class="docutils literal notranslate"><span class="pre">yenBond</span></code> smart contracts  – they
are defined in the <code class="docutils literal notranslate"><span class="pre">bonds</span></code> chaincode. This design helps application programmers
understand whether they are working with commercial papers or bonds priced in
Euros or Yen, and because the rules for each financial product don’t really
change for different currencies, it makes sense to manage their deployment in
the same chaincode.</p>
<p>The <a class="reference external" href="#scenario">diagram</a> also shows the consequences of this deployment choice.
The database management system (DBMS) creates different world state databases
for the <code class="docutils literal notranslate"><span class="pre">papers</span></code> and <code class="docutils literal notranslate"><span class="pre">bonds</span></code> chaincodes and the smart contracts contained within
them. <code class="docutils literal notranslate"><span class="pre">World</span> <span class="pre">state</span> <span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">B</span></code> are each held within distinct
databases; the data are isolated from each other such that a single world state
query (for example) cannot access both world states. The world state is said to
be <em>namespaced</em> according to its chaincode.</p>
<p>See how <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">A</span></code> contains two lists of commercial papers <code class="docutils literal notranslate"><span class="pre">paperListEuro</span></code>
and <code class="docutils literal notranslate"><span class="pre">paperListYen</span></code>. The states <code class="docutils literal notranslate"><span class="pre">PAP11</span></code> and <code class="docutils literal notranslate"><span class="pre">PAP21</span></code> are instances of each paper
managed by the <code class="docutils literal notranslate"><span class="pre">euroPaper</span></code> and <code class="docutils literal notranslate"><span class="pre">yenPaper</span></code> smart contracts respectively. Because
they share the same chaincode namespace, their keys (<code class="docutils literal notranslate"><span class="pre">PAPxyz</span></code>) must be unique
within the namespace of the <code class="docutils literal notranslate"><span class="pre">papers</span></code> chaincode, a little like a street name is
unique within a town. Notice how it would be possible to write a smart contract
in the <code class="docutils literal notranslate"><span class="pre">papers</span></code> chaincode that performed an aggregate calculation over all the
commercial papers – whether priced in Euros or Yen – because they share the
same namespace. The situation is similar for bonds – they are held within
<code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">B</span></code> which maps to a separate <code class="docutils literal notranslate"><span class="pre">bonds</span></code> database, and their keys must
be unique.</p>
<p>Just as importantly, namespaces mean that <code class="docutils literal notranslate"><span class="pre">euroPaper</span></code> and <code class="docutils literal notranslate"><span class="pre">yenPaper</span></code> cannot
directly access <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">B</span></code>, and that <code class="docutils literal notranslate"><span class="pre">euroBond</span></code> and <code class="docutils literal notranslate"><span class="pre">yenBond</span></code> cannot
directly access <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">A</span></code>. This isolation is helpful, as commercial papers
and bonds are very distinct financial instruments; they have different
attributes and are subject to different rules. It also means that <code class="docutils literal notranslate"><span class="pre">papers</span></code> and
<code class="docutils literal notranslate"><span class="pre">bonds</span></code> could have the same keys, because they are in different namespaces. This
is helpful; it provides a significant degree of freedom for naming. Use this
freedom to name different business objects meaningfully.</p>
<p>Most importantly, we can see that a blockchain is associated with the peer
operating in a particular channel, and that it contains transactions that affect
both <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">B</span></code>. That’s because the blockchain is the
most fundamental data structure contained in a peer. The set of world states can
always be recreated from this blockchain, because they are the cumulative
results of the blockchain’s transactions. A world state helps simplify smart
contracts and improve their efficiency, as they usually only require the current
value of a state. Keeping world states separate via namespaces helps smart
contracts isolate their logic from other smart contracts, rather than having to
worry about transactions that correspond to different world states. For example,
a <code class="docutils literal notranslate"><span class="pre">bonds</span></code> contract does not need to worry about <code class="docutils literal notranslate"><span class="pre">paper</span></code> transactions, because it
cannot see their resultant world state.</p>
<p>It’s also worth noticing that the peer, chaincode containers and DBMS all are
logically different processes. The peer and all its chaincode containers are
always in physically separate operating system processes, but the DBMS can be
configured to be embedded or separate, depending on its
<a class="reference external" href="../ledger/ledger.html#world-state-database-options">type</a>. For LevelDB, the
DBMS is wholly contained within the peer, but for CouchDB, it is a separate
operating system process.</p>
<p>It’s important to remember that namespace choices in this example are the result
of a business requirement to share commercial papers in different currencies but
isolate them separate from bonds. Think about how the namespace structure would
be modified to meet a business requirement to keep every financial asset class
separate, or share all commercial papers and bonds?</p>
</div>
<div class="section" id="channels">
<h2>Channels<a class="headerlink" href="#channels" title="Permalink to this headline">¶</a></h2>
<p>If a peer is joined to multiple channels, then a new blockchain is created
and managed for each channel. Moreover, every time a chaincode is instantiated
in a new channel, a new world state database is created for it. It means that
the channel also forms a kind of namespace alongside that of the chaincode for
the world state.</p>
<p>However, the same peer and chaincode container processes can be simultaneously
joined to multiple channels – unlike blockchains, and world state databases,
these processes do not increase with the number of channels joined.</p>
<p>For example, if the <code class="docutils literal notranslate"><span class="pre">papers</span></code> and <code class="docutils literal notranslate"><span class="pre">bonds</span></code> chaincodes were instantiated on a new
channel, there would a totally separate blockchain created, and two new world
state databases created. However, the peer and chaincode containers would not
increase; each would just be connected to multiple channels.</p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>Let’s use our commercial paper <a class="reference external" href="#scenario">example</a> to show how an application
uses a smart contract with namespaces. It’s worth noting that an application
communicates with the peer, and the peer routes the request to the appropriate
chaincode container which then accesses the DBMS. This routing is done by the
peer <strong>core</strong> component shown in the diagram.</p>
<p>Here’s the code for an application that uses both commercial papers and bonds,
priced in Euros and Yen. The code is fairly self-explanatory:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kr">const</span> <span class="nx">euroPaper</span> <span class="o">=</span> <span class="nx">network</span><span class="p">.</span><span class="nx">getContract</span><span class="p">(</span><span class="nx">papers</span><span class="p">,</span> <span class="nx">euroPaper</span><span class="p">);</span>
<span class="nx">paper1</span> <span class="o">=</span> <span class="nx">euroPaper</span><span class="p">.</span><span class="nx">submit</span><span class="p">(</span><span class="nx">issue</span><span class="p">,</span> <span class="nx">PAP11</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">yenPaper</span> <span class="o">=</span> <span class="nx">network</span><span class="p">.</span><span class="nx">getContract</span><span class="p">(</span><span class="nx">papers</span><span class="p">,</span> <span class="nx">yenPaper</span><span class="p">);</span>
<span class="nx">paper2</span> <span class="o">=</span> <span class="nx">yenPaper</span><span class="p">.</span><span class="nx">submit</span><span class="p">(</span><span class="nx">redeem</span><span class="p">,</span> <span class="nx">PAP21</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">euroBond</span> <span class="o">=</span> <span class="nx">network</span><span class="p">.</span><span class="nx">getContract</span><span class="p">(</span><span class="nx">bonds</span><span class="p">,</span> <span class="nx">euroBond</span><span class="p">);</span>
<span class="nx">bond1</span> <span class="o">=</span> <span class="nx">euroBond</span><span class="p">.</span><span class="nx">submit</span><span class="p">(</span><span class="nx">buy</span><span class="p">,</span> <span class="nx">BON31</span><span class="p">);</span>

<span class="kr">const</span> <span class="nx">yenBond</span> <span class="o">=</span> <span class="nx">network</span><span class="p">.</span><span class="nx">getContract</span><span class="p">(</span><span class="nx">bonds</span><span class="p">,</span> <span class="nx">yenBond</span><span class="p">);</span>
<span class="nx">bond2</span> <span class="o">=</span> <span class="nx">yenBond</span><span class="p">.</span><span class="nx">submit</span><span class="p">(</span><span class="nx">sell</span><span class="p">,</span> <span class="nx">BON41</span><span class="p">);</span>
</pre></div>
</div>
<p>See how the application:</p>
<ul class="simple">
<li>Accesses the <code class="docutils literal notranslate"><span class="pre">euroPaper</span></code> and <code class="docutils literal notranslate"><span class="pre">yenPaper</span></code> contracts using the <code class="docutils literal notranslate"><span class="pre">getContract()</span></code>
API specifying the <code class="docutils literal notranslate"><span class="pre">papers</span></code> chaincode. See interaction points <strong>1a</strong> and
<strong>2a</strong>.</li>
<li>Accesses the <code class="docutils literal notranslate"><span class="pre">euroBond</span></code> and <code class="docutils literal notranslate"><span class="pre">yenBond</span></code> contracts using the <code class="docutils literal notranslate"><span class="pre">getContract()</span></code> API
specifying the <code class="docutils literal notranslate"><span class="pre">bonds</span></code> chaincode. See interaction points <strong>3a</strong> and <strong>4a</strong>.</li>
<li>Submits an <code class="docutils literal notranslate"><span class="pre">issue</span></code> transaction to the network for commercial paper <code class="docutils literal notranslate"><span class="pre">PAP11</span></code>
using the <code class="docutils literal notranslate"><span class="pre">euroPaper</span></code> contract. See interaction point <strong>1a</strong>. This results in
the creation of a commercial paper represented by state <code class="docutils literal notranslate"><span class="pre">PAP11</span></code> in <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">A</span></code>; interaction point <strong>1b</strong>. This operation is captured as a
transaction in the blockchain at interaction point <strong>1c</strong>.</li>
<li>Submits a <code class="docutils literal notranslate"><span class="pre">redeem</span></code> transaction to the network for commercial paper <code class="docutils literal notranslate"><span class="pre">PAP21</span></code>
using the <code class="docutils literal notranslate"><span class="pre">yenPaper</span></code> contract. See interaction point <strong>2a</strong>. This results in
the creation of a commercial paper represented by state <code class="docutils literal notranslate"><span class="pre">PAP21</span></code> in <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">A</span></code>; interaction point <strong>2b</strong>. This operation is captured as a
transaction in the blockchain at interaction point <strong>2c</strong>.</li>
<li>Submits a <code class="docutils literal notranslate"><span class="pre">buy</span></code> transaction to the network for bond <code class="docutils literal notranslate"><span class="pre">BON31</span></code> using the
<code class="docutils literal notranslate"><span class="pre">euroBond</span></code> contract. See interaction point <strong>3a</strong>. This results in the
creation of a bond represented by state <code class="docutils literal notranslate"><span class="pre">BON31</span></code> in <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">B</span></code>;
interaction point <strong>3b</strong>. This operation is captured as a transaction in the
blockchain at interaction point <strong>3c</strong>.</li>
<li>Submits a <code class="docutils literal notranslate"><span class="pre">sell</span></code> transaction to the network for bond <code class="docutils literal notranslate"><span class="pre">BON41</span></code> using the
<code class="docutils literal notranslate"><span class="pre">yenBond</span></code> contract. See interaction point <strong>4a</strong>. This results in the creation
of a bond represented by state <code class="docutils literal notranslate"><span class="pre">BON41</span></code> in <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">B</span></code>; interaction point
<strong>4b</strong>. This operation is captured as a transaction in the blockchain at
interaction point <strong>4c</strong>.</li>
</ul>
<p>See how smart contracts interact with the world state:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">euroPaper</span></code> and <code class="docutils literal notranslate"><span class="pre">yenPaper</span></code> contracts can directly access <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">A</span></code>, but
cannot directly access <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">B</span></code>. <code class="docutils literal notranslate"><span class="pre">World</span> <span class="pre">state</span> <span class="pre">A</span></code> is physically held in
the <code class="docutils literal notranslate"><span class="pre">papers</span></code> database in the database management system (DBMS) corresponding
to the <code class="docutils literal notranslate"><span class="pre">papers</span></code> chaincode.</li>
<li><code class="docutils literal notranslate"><span class="pre">euroBond</span></code> and <code class="docutils literal notranslate"><span class="pre">yenBond</span></code> contracts can directly access <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">B</span></code>, but
cannot directly access <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">A</span></code>. <code class="docutils literal notranslate"><span class="pre">World</span> <span class="pre">state</span> <span class="pre">B</span></code> is physically held in
the <code class="docutils literal notranslate"><span class="pre">bonds</span></code> database in the database management system (DBMS) corresponding to
the <code class="docutils literal notranslate"><span class="pre">bonds</span></code> chaincode.</li>
</ul>
<p>See how the blockchain captures transactions for all world states:</p>
<ul class="simple">
<li>Interactions <strong>1c</strong> and <strong>2c</strong> correspond to transactions create and update
commercial papers <code class="docutils literal notranslate"><span class="pre">PAP11</span></code> and <code class="docutils literal notranslate"><span class="pre">PAP21</span></code> respectively. These are both contained
within <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">A</span></code>.</li>
<li>Interactions <strong>3c</strong> and <strong>4c</strong> correspond to transactions both update bonds
<code class="docutils literal notranslate"><span class="pre">BON31</span></code> and <code class="docutils literal notranslate"><span class="pre">BON41</span></code>. These are both contained within <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">B</span></code>.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">A</span></code> or <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">B</span></code> were destroyed for any reason, they
could be recreated by replaying all the transactions in the blockchain.</li>
</ul>
</div>
<div class="section" id="cross-chaincode-access">
<h2>Cross chaincode access<a class="headerlink" href="#cross-chaincode-access" title="Permalink to this headline">¶</a></h2>
<p>As we saw in our example <a class="reference external" href="#scenario">scenario</a>, <code class="docutils literal notranslate"><span class="pre">euroPaper</span></code> and <code class="docutils literal notranslate"><span class="pre">yenPaper</span></code>
cannot directly access <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">B</span></code>.  That’s because we have designed our
chaincodes and smart contracts so that these chaincodes and world states are
kept separately from each other.  However, let’s imagine that <code class="docutils literal notranslate"><span class="pre">euroPaper</span></code> needs
to access <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">B</span></code>.</p>
<p>Why might this happen? Imagine that when a commercial paper was issued, the
smart contract wanted to price the paper according to the current return on
bonds with a similar maturity date.  In this case it will be necessary for the
<code class="docutils literal notranslate"><span class="pre">euroPaper</span></code> contract to be able to query the price of bonds in <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">B</span></code>.
Look at the following diagram to see how we might structure this interaction.</p>
<p><img alt="../_images/develop.diagram.51.png" src="../_images/develop.diagram.51.png" />chaincodens.scenario <em>How chaincodes and smart
contracts can indirectly access another world state – via its chaincode.</em></p>
<p>Notice how:</p>
<ul class="simple">
<li>the application submits an <code class="docutils literal notranslate"><span class="pre">issue</span></code> transaction in the <code class="docutils literal notranslate"><span class="pre">euroPaper</span></code> smart
contract to issue <code class="docutils literal notranslate"><span class="pre">PAP11</span></code>. See interaction <strong>1a</strong>.</li>
<li>the <code class="docutils literal notranslate"><span class="pre">issue</span></code> transaction in the <code class="docutils literal notranslate"><span class="pre">euroPaper</span></code> smart contract calls the <code class="docutils literal notranslate"><span class="pre">query</span></code>
transaction in the <code class="docutils literal notranslate"><span class="pre">euroBond</span></code> smart contract. See interaction point <strong>1b</strong>.</li>
<li>the <code class="docutils literal notranslate"><span class="pre">query</span></code>in <code class="docutils literal notranslate"><span class="pre">euroBond</span></code> can retrieve information from <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">B</span></code>. See
interaction point <strong>1c</strong>.</li>
<li>when control returns to the <code class="docutils literal notranslate"><span class="pre">issue</span></code> transaction, it can use the information in
the response to price the paper and update <code class="docutils literal notranslate"><span class="pre">world</span> <span class="pre">state</span> <span class="pre">A</span></code> with information.
See interaction point <strong>1d</strong>.</li>
<li>the flow of control for issuing commercial paper priced in Yen is the same.
See interaction points <strong>2a</strong>, <strong>2b</strong>, <strong>2c</strong> and <strong>2d</strong>.</li>
</ul>
<p>Control is passed between chaincode using the <code class="docutils literal notranslate"><span class="pre">invokeChaincode()</span></code>
<a class="reference external" href="https://fabric-shim.github.io/master/fabric-shim.ChaincodeStub.html#invokeChaincode__anchor">API</a>.
This API passes control from one chaincode to another chaincode.</p>
<p>Although we have only discussed query transactions in the example, it is
possible to invoke a smart contract which will update the called chaincode’s
world state.  See the <a class="reference external" href="#considerations">considerations</a> below.</p>
</div>
<div class="section" id="considerations">
<h2>Considerations<a class="headerlink" href="#considerations" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>In general, each chaincode will have a single smart contract in it.</li>
<li>Multiple smart contracts should only be deployed in the same chaincode if they
are very closely related.  Usually, this is only necessary if they share the
same world state.</li>
<li>Chaincode namespaces provide isolation between different world states. In
general it makes sense to isolate unrelated data from each other. Note that
you cannot choose the chaincode namespace; it is assigned by Hyperledger
Fabric, and maps directly to the name of the chaincode.</li>
<li>For chaincode to chaincode interactions using the <code class="docutils literal notranslate"><span class="pre">invokeChaincode()</span></code> API,
both chaincodes must be installed on the same peer.<ul>
<li>For interactions that only require the called chaincode’s world state to
be queried, the invocation can be in a different channel to the caller’s
chaincode.</li>
<li>For interactions that require the called chaincode’s world state to be
updated, the invocation must be in the same channel as the caller’s
chaincode.</li>
</ul>
</li>
</ul>
<!--- Licensed under Creative Commons Attribution 4.0 International License
https://creativecommons.org/licenses/by/4.0/ --></div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="transactioncontext.html" class="btn btn-neutral float-right" title="Transaction context" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="namespace.html" class="btn btn-neutral" title="Contract namespaces" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Hyperledger 2019.
    <br>
      <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
        <img alt="Creative Commons License" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>